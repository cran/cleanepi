<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to cleanepi</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to cleanepi</h1>



<div id="an-overview" class="section level1">
<h1>An overview</h1>
<p>Data cleaning is a critical step of data analysis, especially
considering the messy nature of real-world data, which often includes
duplicates, errors, incomplete entries, irrelevant formats, etc.
Addressing these issues is essential for producing accurate, reliable,
and reproducible results. However, data cleaning can pose a substantial
barrier in data analysis due to the time-consuming nature of the
process.</p>
<p><strong>{cleanepi}</strong> is an R package designed specifically to
address this challenge by offering tools to clean, curate, and
standardize datasets. Tailored specifically for epidemiological data and
compatible with data frame-like structures, <strong>{cleanepi}</strong>
offers a suite of functions designed to streamline common data cleaning
tasks.</p>
<p>This vignette provides a comprehensive guide to the functionalities
encapsulated within <strong>{cleanepi}</strong>. It provides users with
detailed insights into each function’s purpose and practical usage,
equipping them with the tools necessary to navigate and manipulate
cluttered datasets effectively.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;cleanepi&quot;</span>)</span></code></pre></div>
</div>
<div id="general-data-cleaning-tasks" class="section level1">
<h1>General data cleaning tasks</h1>
<p>The main function in <strong>{cleanepi}</strong> is
<code>clean_data()</code> that can perform the following tasks:</p>
<ol style="list-style-type: decimal">
<li>Clean up column names and convert them to more readable formats.
This includes many sub-tasks such as replacing a space, dot, or hyphen
between two words with underscore; converting camel-cases to
snake-cases; substituting foreign characters with their corresponding
English characters; and splitting a long word into multiple short words
by capital characters within, if any, and connecting them with
underscores.<br />
</li>
<li>Find and remove duplicated rows across all or some specific
columns.</li>
<li>Remove empty rows and columns as well as constant columns,
i.e. columns with the same value across all rows.<br />
</li>
<li>Replace missing entries with <code>NA</code>.</li>
<li>Standardizes date formats and verifies that the sequence of date
events follows the correct chronological order across columns for all
rows in the input data.</li>
<li>Convert <code>character</code> columns into <code>Date</code> if the
column actually contains values of type <code>Date</code> to some extent
(default is at least 60% of the values are <code>Date</code>).</li>
<li>Detect and remove rows with subject ids that do not comply with the
expected format.</li>
<li>Perform dictionary-based cleaning: replace keys in specific columns
with their corresponding values stored in a data dictionary provided as
a data frame, detect and replace misspelled values with their correct
ones.</li>
<li>Convert numbers written in characters into numeric.</li>
<li>Calculate the time span between columns or values of type Date.</li>
<li>Convert numeric values into Date.</li>
</ol>
<p>In addition, the package also has two surrogate functions:<br />
1. <code>scan_data()</code>: scan the input data to determine the
percent of missing, numeric, character, logical and date values in every
character column of the input data frame.<br />
2. <code>print_report()</code>: print the data cleaning report.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># IMPORTING THE </span><span class="al">TEST</span><span class="co"> DATASET</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:right;">
-99
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># SCAN THE DATA</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>scan_result <span class="ot">&lt;-</span> <span class="fu">scan_data</span>(test_data)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Field_names
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
missing
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
numeric
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
date
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
character
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
logical
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
study_id
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
event_name
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
country_name
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
date.of.admission
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
dateOfBirth
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.1
</td>
<td style="text-align:right;">
0.9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
date_first_pcr_positive_test
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0
</td>
<td style="text-align:right;">
1.0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
</div>
<p>In <strong>{cleanepi}</strong>, every cleaning operation is
encapsulated within a module, with detailed descriptions provided in the
package <a href="design_principle.html">design vignette</a>. The
parameters required for the main functions of each module are outlined
in the sections below.</p>
<p>The <code>clean_data()</code> function, described above, can take the
following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: a <code>data.frame</code> or
<code>linelist</code>.</li>
<li><strong>standardize_column_names</strong>: a list of parameters to
be used for standardizing the column names. These arguments are the
inputs for the <code>standardize_column_names()</code> function.</li>
<li><strong>replace_missing_values</strong>: a list of parameters to be
used when replacing the missing values by <code>NA</code>. Elements of
this list are the inputs for the <code>replace_missing_values()</code>
function.</li>
<li><strong>remove_duplicates</strong>: a list with the arguments that
define the columns and other parameters to be considered when looking
for duplicates. They are the input values for the
<code>remove_duplicates()</code> function.</li>
<li><strong>remove_constants</strong>: a list with the parameters that
define whether to remove constant data or not. The values are the input
for the <code>remove_constants()</code> function.</li>
<li><strong>standardize_dates</strong>: a list of parameters that will
be used to standardize the date values from the input data. They
represent the input values for the <code>standardize_dates()</code>
function.</li>
<li><strong>standardize_subject_ids</strong>: a list of parameters that
are needed to check whether the subject IDs comply with the expected
format. These arguments are the input values of the
<code>check_subject_ids()</code>.</li>
<li><strong>to_numeric</strong>: a list with the parameters needed to
convert the specified columns into numeric. When provided, the
parameters will be the input values for the
<code>convert_to_numeric()</code> function.</li>
<li><strong>dictionary</strong>: a data frame that will be used to
substitute the current values in the specified columns with those in the
dictionary. It is the main argument for the
<code>clean_using_dictionary()</code> function.</li>
<li><strong>check_date_sequence</strong>: a list of arguments to be used
when determining whether the sequence of the target date events is
respected across all rows of the input data. The elements of this list
are the input for the <code>check_date_sequence()</code> function.</li>
</ol>
<p><strong>It is important to note that only cleaning operations that
are explicitly defined will be performed.</strong></p>
<p>The below code chunk shows how to define a set of cleaning operations
that we want to perform on the input data.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># PARAMETERS FOR REPLACING MISSING VALUES WITH NA</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>replace_missing_values <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">target_columns =</span> <span class="cn">NULL</span>, <span class="at">na_strings =</span> <span class="st">&quot;-99&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># PARAMETERS FOR COLUMN NAMES STANDARDIZATION</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>standardize_column_names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">keep =</span> <span class="cn">NULL</span>, <span class="at">rename =</span> <span class="cn">NULL</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="co"># PARAMETERS FOR DUBLICATES DETECTION AND REMOVAL</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>remove_duplicates <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">target_columns =</span> <span class="cn">NULL</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co"># PARAMETERS FOR STANDARDING DATES</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>standardize_dates <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  <span class="at">error_tolerance =</span> <span class="fl">0.4</span>,</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  <span class="at">format =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>  <span class="at">timeframe =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;1973-05-29&quot;</span>, <span class="st">&quot;2023-05-29&quot;</span>)),</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>  <span class="at">orders =</span> <span class="fu">list</span>(</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>    <span class="at">world_named_months =</span> <span class="fu">c</span>(<span class="st">&quot;Ybd&quot;</span>, <span class="st">&quot;dby&quot;</span>),</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>    <span class="at">world_digit_months =</span> <span class="fu">c</span>(<span class="st">&quot;dmy&quot;</span>, <span class="st">&quot;Ymd&quot;</span>),</span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>    <span class="at">US_formats =</span> <span class="fu">c</span>(<span class="st">&quot;Omdy&quot;</span>, <span class="st">&quot;YOmd&quot;</span>)</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  )</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>)</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a><span class="co"># PARAMETERS FOR STANDARDING SUBJECT ids</span></span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>standardize_subject_ids <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;study_id&quot;</span>,</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;PS&quot;</span>,</span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a>  <span class="at">suffix =</span> <span class="st">&quot;P2&quot;</span>,</span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>  <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">100</span>),</span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a>  <span class="at">nchar =</span> <span class="dv">7</span></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a>)</span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a><span class="co"># CONVERT THE &#39;sex&#39; COLUMN INTO NUMERIC</span></span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a>to_numeric <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">target_columns =</span> <span class="st">&quot;sex&quot;</span>, <span class="at">lang =</span> <span class="st">&quot;en&quot;</span>)</span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a><span class="co"># PARAMETERS FOR CONSTANT COLUMNS, EMPTY ROWS AND COLUMNS REMOVAL</span></span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>remove_constants <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">cutoff =</span> <span class="dv">1</span>)</span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a><span class="co"># LAOD THE DATA DICTIONARY FOR DICTIONARY-BASED CLEANING</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a>dictionary <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(</span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_dictionary.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)</span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># CLEAN THE INPUT DATA FRAME</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">clean_data</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">data =</span> test_data,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">remove_constants =</span> remove_constants,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">replace_missing_values =</span> replace_missing_values,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">remove_duplicates =</span> remove_duplicates,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">standardize_dates =</span> standardize_dates,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="at">standardize_subject_ids =</span> standardize_subject_ids,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="at">to_numeric =</span> to_numeric,</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="at">dictionary =</span> dictionary</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt; ℹ Cleaning column names</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt; ℹ Replacing missing values with NA</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt; ℹ Removing constant columns and empty rows</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt; ℹ Removing duplicated rows</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt; ℹ No duplicates were found.</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt; ℹ Standardizing Date columns</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt; ℹ Checking subject IDs format</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a><span class="co">#&gt; ! Detected 3 invalid subject ids at lines: &quot;3, 5, 7&quot;.</span></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co">#&gt; ℹ You can use the `correct_subject_ids()` function to correct them.</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a><span class="co">#&gt; ℹ Converting the following  column into numeric: sex</span></span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a><span class="co">#&gt; ℹ Performing dictionary-based cleaning</span></span></code></pre></div>
<p>It returns the cleaned dataset. The report generated from the data
cleaning operations is a <code>list object</code> that is attached to
the cleaned data and can be accessed using the <code>attr()</code> or
<code>attributes()</code> function. The report show details of outcome
of each cleaning operation that was performed during the process. Users
can access the report using the code below:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># ACCESS THE DATA CLEANING REPORT</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>report <span class="ot">&lt;-</span> <span class="fu">attr</span>(cleaned_data, <span class="st">&quot;report&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co"># SUMMARIZE THE REPORT OBJECT</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">summary</span>(report)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;                            Length Class      Mode     </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; colnames                   2      data.frame list     </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; missing_values_replaced_at 1      -none-     character</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; constant_data              4      data.frame list     </span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; out_of_range_dates         3      data.frame list     </span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; multi_format_dates         5      data.frame list     </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; incorrect_subject_id       2      data.frame list     </span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; converted_into_numeric     1      -none-     character</span></span></code></pre></div>
<p>They can also display the report in a web browser using the
<code>print_report()</code> function as shown below:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">print_report</span>(cleaned_data)</span></code></pre></div>
</div>
<div id="specific-data-cleaning-tasks" class="section level1">
<h1>Specific data cleaning tasks</h1>
<p><strong>{cleanepi}</strong> luckily provides users with the
flexibility to call a specific function if they wish to perform that
particular task individually. This approach allows users to have more
control over the data cleaning process and to apply additional data
cleaning functions as needed.</p>
<p>For example, some data cleaning operations, such as renaming columns,
removing empty rows and columns, removing columns with the same values
across all rows, and standardizing date columns, play a central role in
standardizing the epidemiological data. These operations can be
performed within the framework of the <code>clean_data()</code> function
or alone by calling the relevant function.</p>
<p>This setup offers users both convenience and flexibility, as they can
perform all the cleaning operations at once, or execute them
individually according to their specific needs.</p>
<div id="remove-constant-data" class="section level2">
<h2>Remove constant data</h2>
<p>Some datasets contain constant columns (columns with the same values
across all rows), and/or empty rows and columns (rows or columns where
all values are missing i.e <code>NA</code>). The
<code>remove_constants()</code> function can be used to remove such
“noise”. The function takes the following argument:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: the input data frame or linelist,</li>
<li><strong>cutoff</strong>: a numeric, between <code>0</code> and
<code>1</code>, to be used when removing empty rows and columns. When
provided, only rows and columns where the percent of missing data is
greater than this cut-off will removed. Rows and columns with 100%
missing values will be remove by default.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># IMPORT THE INPUT DATA</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># INTRODUCE AN EMPTY COLUMN</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>data<span class="sc">$</span>empty_column <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co"># remove the constant columns, empty rows and columns</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">remove_constants</span>(</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="at">cutoff =</span> <span class="dv">1</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:right;">
-99
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<p>The <code>remove_constants()</code> function returns a dataset where
all constant columns, empty rows and columns are iteratively removed.
Note that when the first iteration of constant data removal results in a
dataset with new empty rows and/or columns and constant columns, this
process will be repeated several times until there is no more constant
data. Rows and columns that were deleted at any iterations will be
mentioned in the report object.</p>
</div>
<div id="cleaning-column-names" class="section level2">
<h2>Cleaning column names</h2>
<p>The syntax used to name the columns of a dataset during its creation
depends on many factors such as the language, the naming convention,
etc. We provide, in <strong>{cleanepi}</strong>, the
<code>standardize_column_names()</code> function to clean up column
names and convert them to more intuitive formats. It performs many
sub-tasks including: replacing a space, dot, or hyphen between two words
with underscore; converting camel-cases to snake-cases; substituting
foreign characters with their corresponding English characters; and
splitting along word into multiple short words by capital characters
within, if any, and connecting them with underscores. The function can
take the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: the input data frame or linelist</li>
<li><strong>keep</strong>: a vector of column names to maintain as they
are. When dealing with a linelist, this can be set to
<code>linelist_tags</code>, to maintain the tagged column names. The
Default is <code>NULL</code>.</li>
<li><strong>rename</strong>: a vector of column names to be renamed in
the form of <code>new_name = &quot;old_name&quot;</code>. If not provided, all
columns will undergo standardization.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># IMPORT AND PRINT THE INITAL COLUMN NAMES</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">colnames</span>(data))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;study_id&quot;                     &quot;event_name&quot;                  </span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; [3] &quot;country_code&quot;                 &quot;country_name&quot;                </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; [5] &quot;date.of.admission&quot;            &quot;dateOfBirth&quot;                 </span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; [7] &quot;date_first_pcr_positive_test&quot; &quot;sex&quot;</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co"># KEEP &#39;date.of.admission&#39; AS IS</span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">standardize_column_names</span>(</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>  <span class="at">keep =</span> <span class="st">&quot;date.of.admission&quot;</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">colnames</span>(cleaned_data))</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;study_id&quot;                     &quot;event_name&quot;                  </span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; [3] &quot;country_code&quot;                 &quot;country_name&quot;                </span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; [5] &quot;date.of.admission&quot;            &quot;date_of_birth&quot;               </span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; [7] &quot;date_first_pcr_positive_test&quot; &quot;sex&quot;</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co"># KEEP &#39;date.of.admission&#39; AS IS, BUT RENAME &#39;dateOfBirth&#39; AND &#39;sex&#39; TO</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co"># &#39;DOB&#39; AND &#39;gender&#39; RESPECTIVELY</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">standardize_column_names</span>(</span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a>  <span class="at">keep =</span> <span class="st">&quot;date.of.admission&quot;</span>,</span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a>  <span class="at">rename =</span> <span class="fu">c</span>(<span class="at">DOB =</span> <span class="st">&quot;dateOfBirth&quot;</span>, <span class="at">gender =</span> <span class="st">&quot;sex&quot;</span>)</span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a>)</span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">colnames</span>(cleaned_data))</span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; [1] &quot;study_id&quot;                     &quot;event_name&quot;                  </span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; [3] &quot;country_code&quot;                 &quot;country_name&quot;                </span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; [5] &quot;date.of.admission&quot;            &quot;DOB&quot;                         </span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; [7] &quot;date_first_pcr_positive_test&quot; &quot;gender&quot;</span></span></code></pre></div>
<p>By providing the function with these parameters, the users can
redefine the name of the columns and get easy to work with column names.
This enables a more comprehensive naming system that is tailored to the
needs of the user.</p>
</div>
<div id="replacing-missing-entries-with-na" class="section level2">
<h2>Replacing missing entries with <code>NA</code></h2>
<p>It is common to have missing values in an input dataset. By default,
R expects missing values to be represented by <code>NA</code>, However,
this is not always the case as some dataset can contain a specific
character string that denotes the missing value. In the presence of such
a scenario, users can call the <code>replace_missing_values()</code>
function to substitute these missing values with <code>NA</code>. This
will make the data suitable for any data science operations. The
function takes the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: the input data frame or linelist.</li>
<li><strong>target_columns</strong>: a vector of column names. If
provided, the substitution of missing values will only be executed in
those specified columns. When the input data is a <code>linelist</code>
object, this parameter can be set to <code>linelist_tags</code> if you
wish to replace missing values with <code>NA</code> on tagged columns
only. The default value is <code>NULL</code> i.e. replace missing values
across all columns.</li>
<li><strong>na_strings</strong>: a vector of character strings that
represents the missing values in the columns of interest. By default, it
utilizes <code>cleanepi::common_na_strings</code>. However, if the
missing values string in the columns of interest is not included in this
predefined vector, it can be used as the value for this argument.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># VISUALIZE THE PREDEFINED VECTOR OF MISSING CHARACTERS</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">print</span>(cleanepi<span class="sc">::</span>common_na_strings)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;missing&quot;       &quot;NA&quot;            &quot;N A&quot;           &quot;N/A&quot;          </span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;#N/A&quot;          &quot;NA &quot;           &quot; NA&quot;           &quot;N /A&quot;         </span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;N / A&quot;         &quot; N / A&quot;        &quot;N / A &quot;        &quot;na&quot;           </span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; [13] &quot;n a&quot;           &quot;n/a&quot;           &quot;na &quot;           &quot; na&quot;          </span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; [17] &quot;n /a&quot;          &quot;n / a&quot;         &quot; a / a&quot;        &quot;n / a &quot;       </span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; [21] &quot;NULL&quot;          &quot;null&quot;          &quot;&quot;              &quot;\\?&quot;          </span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; [25] &quot;\\*&quot;           &quot;\\.&quot;           &quot;not available&quot; &quot;Not Available&quot;</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; [29] &quot;NOt available&quot; &quot;not avail&quot;     &quot;Not Avail&quot;     &quot;nan&quot;          </span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; [33] &quot;NAN&quot;           &quot;not a number&quot;  &quot;Not A Number&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># REPLACE ALL OCCURENCES OF &quot;-99&quot; WITH NA IN THE &quot;sex&quot; COLUMN</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">replace_missing_values</span>(</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)),</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;sex&quot;</span>,</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  <span class="at">na_strings =</span> <span class="st">&quot;-99&quot;</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co"># REPLACE ALL OCCURENCES OF &quot;-99&quot; WITH NA FROM ALL COLUMNS</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">replace_missing_values</span>(</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)),</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="cn">NULL</span>,</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>  <span class="at">na_strings =</span> <span class="st">&quot;-99&quot;</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="standardizing-dates" class="section level2">
<h2>Standardizing Dates</h2>
<p>The default date format in R is <code>Ymd</code> (the ISO8601
format). However, it is very common to encounter date values that are
written differently from this. Also, there are cases where a column in a
data frame contains both values of type <code>Date</code>,
<code>character</code> or others.</p>
<p>The <code>standardize_dates()</code> function provides a
comprehensive set of options for converting date columns into a
specified format and handling various scenarios, such as different date
formats and mixed data types in a column.</p>
<p>Entries which cannot be processed result in <code>NA</code>. An error
threshold can be used to define the maximum number of resulting
<code>NA</code> (i.e. entries without an identified date) that can be
tolerated. If this threshold is exceeded, the initial values will be
returned.</p>
<p>The function expects the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: A data frame or linelist (required).<br />
</li>
<li><strong>target_columns</strong>: A vector of the names of the
columns to be converted (optional). When not provided, the function will
attempt to detect date columns and perform the conversion if the
conditions above are met.</li>
<li><strong>format</strong>: A format of the values in the specified
columns (optional). If not provided, the function will attempt to infer
the format.</li>
<li><strong>timeframe</strong>: The expected time frame within which the
date values should fall. Values outside of this range will be set to
<code>NA</code> (optional).</li>
<li><strong>error_tolerance</strong>: The maximum percentage of
<code>NA</code> values (non date values) that can be allowed in a
converted column. Default is 40% i.e. <code>0.4</code>.</li>
<li><strong>orders</strong>: A character vector or list of codes for
fine-grained parsing of dates. It is used for parsing of mixed dates. If
a list is supplied, that list will be used for successive tries in
parsing. Default is:</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>orders <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>  <span class="at">quarter_partial_dates =</span> <span class="fu">c</span>(<span class="st">&quot;Y&quot;</span>, <span class="st">&quot;Ym&quot;</span>, <span class="st">&quot;Yq&quot;</span>),</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  <span class="at">world_digit_months =</span> <span class="fu">c</span>(<span class="st">&quot;ymd&quot;</span>, <span class="st">&quot;ydm&quot;</span>, <span class="st">&quot;dmy&quot;</span>, <span class="st">&quot;mdy&quot;</span>, <span class="st">&quot;myd&quot;</span>, <span class="st">&quot;dym&quot;</span>, <span class="st">&quot;Ymd&quot;</span>, <span class="st">&quot;Ydm&quot;</span>,</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>                         <span class="st">&quot;dmY&quot;</span>, <span class="st">&quot;mdY&quot;</span>, <span class="st">&quot;mYd&quot;</span>, <span class="st">&quot;dYm&quot;</span>),</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="at">world_named_months =</span> <span class="fu">c</span>(<span class="st">&quot;dby&quot;</span>, <span class="st">&quot;dyb&quot;</span>, <span class="st">&quot;bdy&quot;</span>, <span class="st">&quot;byd&quot;</span>, <span class="st">&quot;ybd&quot;</span>, <span class="st">&quot;ydb&quot;</span>, <span class="st">&quot;dbY&quot;</span>, <span class="st">&quot;dYb&quot;</span>,</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>                         <span class="st">&quot;bdY&quot;</span>, <span class="st">&quot;bYd&quot;</span>, <span class="st">&quot;Ybd&quot;</span>, <span class="st">&quot;Ydb&quot;</span>),</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="at">us_format =</span> <span class="fu">c</span>(<span class="st">&quot;Omdy&quot;</span>, <span class="st">&quot;YOmd&quot;</span>)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>)</span></code></pre></div>
<blockquote>
<p>⚠️ The <code>error_tolerance</code> must be used with caution. When
it is set, and the percentage of non-date values (NA i.e. values that
were not converted into date) in a character column is greater than this
threshold, the column will be returned as it is. The values outside of
this timeframe can be accessed from the report object via its
<code>out_of_range_dates</code> element.</p>
</blockquote>
<blockquote>
<p>The value for the <code>orders</code> argument can be modified to
suit the user’s needs. Other date formats can be specified too. For
instance, if you want to prioritize American-style dates with numeric
months, you can switch the second and third elements of the default
orders as shown below:</p>
</blockquote>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># GIVE PRIORITY TO AMERICAN-STYLE DATES</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>us_ord <span class="ot">&lt;-</span> orders[<span class="fu">c</span>(<span class="dv">1</span><span class="dt">L</span>, <span class="dv">3</span><span class="dt">L</span>, <span class="dv">2</span><span class="dt">L</span>)]</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># ADD A FORMAT WITH HOURS TO THE EXISTING orders</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># THIS WILL ALLOW FOR THE CONVERSION OF VALUES SUCH AS &quot;2014_04_05_23:15:43&quot;</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="co"># WHEN THEY APPEAR IN THE TARGET COLUMNS.</span></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>orders<span class="sc">$</span>ymdhms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Ymdhms&quot;</span>, <span class="st">&quot;Ymdhm&quot;</span>)</span></code></pre></div>
<p>This function provides users with the flexibility to standardize date
columns in their dataset according to specified requirements, including
<code>format</code>, <code>timeframe</code>, and
<code>error tolerance</code> for conversion from character to date
columns.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># STANDARDIZE VALUES IN THE &#39;date_first_pcr_positive_test&#39; COLUMN</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="fu">head</span>(test_data<span class="sc">$</span>date_first_pcr_positive_test)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Dec 01, 2020&quot; &quot;Jan 01, 2021&quot; &quot;Feb 11, 2021&quot; &quot;Feb 01, 2021&quot; &quot;Feb 16, 2021&quot;</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; [6] &quot;May 02, 2021&quot;</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">standardize_dates</span>(</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>  <span class="at">data =</span> test_data,</span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;date_first_pcr_positive_test&quot;</span>,</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>  <span class="at">format =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>  <span class="at">timeframe =</span> <span class="cn">NULL</span>,</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>  <span class="at">error_tolerance =</span> <span class="fl">0.4</span>,</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>  <span class="at">orders =</span> <span class="fu">list</span>(</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>    <span class="at">world_named_months =</span> <span class="fu">c</span>(<span class="st">&quot;Ybd&quot;</span>, <span class="st">&quot;dby&quot;</span>),</span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>    <span class="at">world_digit_months =</span> <span class="fu">c</span>(<span class="st">&quot;dmy&quot;</span>, <span class="st">&quot;Ymd&quot;</span>),</span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>    <span class="at">US_formats =</span> <span class="fu">c</span>(<span class="st">&quot;Omdy&quot;</span>, <span class="st">&quot;YOmd&quot;</span>)</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>  )</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>)</span></code></pre></div>
<p>This function returns the input dataset where the (specified) columns
are converted into Date if the conditions are met.</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
2020-12-01
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
2021-01-01
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
2021-02-11
</td>
<td style="text-align:right;">
-99
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
2021-02-01
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
2021-02-16
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
2021-05-02
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
2021-02-19
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
2021-09-20
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
2021-02-26
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
2021-03-03
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
<p>It also adds two or three elements to the report object:</p>
<ul>
<li>A data frame with the columns where date values were
standardized,</li>
<li>A data frame with the values that fall outside of the specified
timeframe,</li>
<li>A data frame featuring date values that can comply with more than
one specified format.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># STANDARDIZE VALUES IN ALL COLUMNS</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">standardize_dates</span>(</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="at">data =</span> test_data,</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  <span class="at">format =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  <span class="at">timeframe =</span> <span class="cn">NULL</span>,</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  <span class="at">error_tolerance =</span> <span class="fl">0.4</span>,</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="at">orders =</span> <span class="fu">list</span>(</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>    <span class="at">world_named_months =</span> <span class="fu">c</span>(<span class="st">&quot;Ybd&quot;</span>, <span class="st">&quot;dby&quot;</span>),</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a>    <span class="at">world_digit_months =</span> <span class="fu">c</span>(<span class="st">&quot;dmy&quot;</span>, <span class="st">&quot;Ymd&quot;</span>),</span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>    <span class="at">US_formats =</span> <span class="fu">c</span>(<span class="st">&quot;Omdy&quot;</span>, <span class="st">&quot;YOmd&quot;</span>)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a>  )</span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt; ! Found &lt;numeric&gt; values that could also be of type &lt;Date&gt; in column:</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt;   dateOfBirth.</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt; ℹ It is possible to convert them into &lt;Date&gt; using: `lubridate::as_date(x,</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt;   origin = as.Date(&quot;1900-01-01&quot;))`</span></span>
<span id="cb15-18"><a href="#cb15-18" tabindex="-1"></a><span class="co">#&gt; • where &quot;x&quot; represents here the vector of values from these columns</span></span>
<span id="cb15-19"><a href="#cb15-19" tabindex="-1"></a><span class="co">#&gt;   (`data$target_column`).</span></span>
<span id="cb15-20"><a href="#cb15-20" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" tabindex="-1"></a><span class="co"># GET THE REPORT</span></span>
<span id="cb15-22"><a href="#cb15-22" tabindex="-1"></a>report <span class="ot">&lt;-</span> <span class="fu">attr</span>(res, <span class="st">&quot;report&quot;</span>)</span></code></pre></div>
<p>Below are the possible formats for the date columns based on the
specified potential formats from the <code>orders</code> argument.</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
field
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
idx
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
world_named_months
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
world_digit_months
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
US_formats
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
date.of.admission
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2020-12-01
</td>
<td style="text-align:left;">
2020-01-12
</td>
</tr>
<tr>
<td style="text-align:left;">
date.of.admission
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2021-02-11
</td>
<td style="text-align:left;">
2021-11-02
</td>
</tr>
<tr>
<td style="text-align:left;">
date.of.admission
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2021-03-02
</td>
<td style="text-align:left;">
2021-02-03
</td>
</tr>
<tr>
<td style="text-align:left;">
date.of.admission
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2021-03-05
</td>
<td style="text-align:left;">
2021-05-03
</td>
</tr>
<tr>
<td style="text-align:left;">
dateOfBirth
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1972-01-06
</td>
<td style="text-align:left;">
1972-06-01
</td>
</tr>
<tr>
<td style="text-align:left;">
dateOfBirth
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1989-03-11
</td>
<td style="text-align:left;">
1989-11-03
</td>
</tr>
<tr>
<td style="text-align:left;">
dateOfBirth
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1976-05-10
</td>
<td style="text-align:left;">
1976-10-05
</td>
</tr>
<tr>
<td style="text-align:left;">
dateOfBirth
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
1991-08-02
</td>
<td style="text-align:left;">
1991-02-08
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="standardizing-subject-ids" class="section level2">
<h2>Standardizing subject IDs</h2>
<div id="detecting-incorrect-duplicated-and-missing-subject-ids" class="section level3">
<h3>Detecting incorrect, duplicated, and missing subject IDs</h3>
<p>The <code>check_subject_ids()</code> function is designed to identify
rows from the input dataset where the IDs don’t comply with the expected
subject IDs format. It expects the following parameters:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: A data frame or linelist (required).</li>
<li><strong>target_columns</strong>: The name of the column containing
the subject IDs in the dataset (required).</li>
<li><strong>nchar</strong>: The expected number of character in the
subject ids (optional).</li>
<li><strong>prefix</strong>: A string. If subject IDs have a specific
prefix, it is used as a value for this argument. This is optional and
can be omitted if there is no prefix.</li>
<li><strong>suffix</strong>: A string. If subject IDs have a specific
suffix, it is used as a value for this argument. It can be ignored
otherwise.</li>
<li><strong>range</strong>: A vector of two elements. If there is an
expected range of numbers within the subject IDs, define it using this
parameter. It is optional and can be omitted if there is no specific
range.</li>
</ol>
<p>By providing these parameters, the function becomes a versatile tool
for data cleaning, ensuring that the user is alerted on the presence of
unexpected, missing and duplicated subject IDs. When using the function,
make sure to tailor the parameters according to the specific
requirements of your dataset and the expected characteristics of the
subject IDs.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># DETECT AND REMOVE INCORRECT SUBJECT IDs</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">check_subject_ids</span>(</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)),</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;study_id&quot;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>  <span class="at">prefix =</span> <span class="st">&quot;PS&quot;</span>,</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  <span class="at">suffix =</span> <span class="st">&quot;P2&quot;</span>,</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="dt">L</span>, <span class="dv">100</span><span class="dt">L</span>),</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  <span class="at">nchar =</span> <span class="dv">7</span><span class="dt">L</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co">#&gt; ! Detected 3 invalid subject ids at lines: &quot;3, 5, 7&quot;.</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a><span class="co">#&gt; ℹ You can use the `correct_subject_ids()` function to correct them.</span></span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co"># EXTRACT REPORT</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>report <span class="ot">&lt;-</span> <span class="fu">attr</span>(res, <span class="st">&quot;report&quot;</span>)</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co"># DISPLAY THE INCORRECT SUBJECT IDs</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="fu">print</span>(report<span class="sc">$</span>incorrect_subject_id)</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="co">#&gt;   idx       ids</span></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co">#&gt; 1   3 PS004P2-1</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a><span class="co">#&gt; 2   5   P0005P2</span></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="co">#&gt; 3   7   PB500P2</span></span></code></pre></div>
<p>The <code>check_subject_ids()</code> function returns the input
dataset and send a warming when there are some incorrect ids.</p>
<p>In addition to detecting undesirable subject IDs, the function will
also look for missing and duplicated IDs. As the result of this, the
report made from this operation might contain two extra elements:
<strong>missing_ids</strong> (a vector of row indexes where there is a
missing IDs) and <strong>duplicated_ids</strong> (a data frame of rows
with the duplicated IDs). Use the <code>print_report()</code> function
to display the report made from this operation.</p>
</div>
<div id="correct-wrong-subject-ids" class="section level3">
<h3>Correct wrong subject ids</h3>
<p>After the detection of the incorrect subject ids using the
<code>check_subject_ids()</code>, use the
<code>correct_subject_ids()</code> to replace non complying ids with the
correct ones. The function requires a data frame with the following two
columns:</p>
<ol style="list-style-type: decimal">
<li><strong>from</strong>: a column with the incorrect subject ids,</li>
<li><strong>to</strong>: a column with the values to be used to
substitute the incorrect ids.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># IMPORT THE INPUT DATA</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co"># GENERATE THE CORRECTION TABLE</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>correction_table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;P0005P2&quot;</span>, <span class="st">&quot;PB500P2&quot;</span>, <span class="st">&quot;PS004P2-1&quot;</span>),</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">c</span>(<span class="st">&quot;PB005P2&quot;</span>, <span class="st">&quot;PB050P2&quot;</span>, <span class="st">&quot;PS004P2&quot;</span>),</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co"># PERFORM THE CORRECTION</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">correct_subject_ids</span>(</span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;study_id&quot;</span>,</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>  <span class="at">correction_table =</span> correction_table</span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="checking-date-sequence" class="section level2">
<h2>Checking date sequence</h2>
<p>The <code>check_date_sequence()</code> function verifies the order of
sequences in date event columns within a dataset. It ensures that the
values in the specified date columns follow the desired chronological
order. Here are the arguments accepted by the function:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: A data frame or linelist (required).</li>
<li><strong>target_columns</strong>: A vector containing the names of
the date columns of interest. These columns should be listed in the
expected order of occurrence that reflects the chronological sequence of
events. For example,
<code>target_columns = c(&quot;date_of_infection&quot;, &quot;date_of_admission&quot;, &quot;date_of_death&quot;)</code>.</li>
</ol>
<p>By utilizing these arguments, the <code>check_date_sequence()</code>
function facilitates the validation of date sequences within a dataset,
ensuring data integrity and accuracy for further analysis. Additionally,
it offers flexibility by allowing users to choose whether to remove rows
with incorrect sequences or store them for further examination in the
report object.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co"># IMPORT THE DATA AND STANDARDIZE THE TARGET DATE COLUMNS</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">standardize_dates</span>(</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  data,</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="fu">c</span>(<span class="st">&quot;date_first_pcr_positive_test&quot;</span>, <span class="st">&quot;date.of.admission&quot;</span>)</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co"># DETECT ROWS WITH INCORRECT DATE SEQUENCE</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">check_date_sequence</span>(</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="fu">c</span>(<span class="st">&quot;date_first_pcr_positive_test&quot;</span>, <span class="st">&quot;date.of.admission&quot;</span>)</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>)</span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; ! Detected 2 incorrect date sequences at lines: &quot;6, 8&quot;.</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt; ℹ Enter `attr(dat, &quot;report&quot;)[[&quot;incorrect_date_sequence&quot;]]` to access them,</span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt;   where &quot;dat&quot; is the object used to store the output from this operation.</span></span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a><span class="co"># DISPLAY THE INCORRECT SEQUENCES OF DATE</span></span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>incorrect_sequence <span class="ot">&lt;-</span> <span class="fu">attr</span>(res, <span class="st">&quot;report&quot;</span>)[[<span class="st">&quot;incorrect_date_sequence&quot;</span>]]</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a><span class="fu">print</span>(incorrect_sequence)</span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a><span class="co">#&gt;   row_id date_first_pcr_positive_test date.of.admission</span></span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a><span class="co">#&gt; 6      6                   2021-05-02        2021-02-17</span></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co">#&gt; 8      8                   2021-09-20        2021-02-22</span></span></code></pre></div>
<p>The <code>check_date_sequence()</code> function returns the input
dataset, augmented with an attributes named as
<code>incorrect_date_sequence</code> if there are rows with incorrect
date sequences. This attribute highlights any discrepancies found in the
date sequences, enabling users to take appropriate actions. Use the
<code>print_report()</code> function to display the report made from
this operation.</p>
</div>
<div id="converting-character-columns-into-numeric" class="section level2">
<h2>Converting character columns into numeric</h2>
<p>In certain scenarios, the input data contains columns where the
numbers are written in letters. For instance, the ages of a study
participants can be written in letters. Similarly, a column can contain
values written in both numbers and letters (an age column where some
values are written in numbers and others in letters). The
<code>convert_to_numeric()</code> function offers the framework to
convert all numbers written in letters from a given column into numeric.
It makes call of the main function from the <a href="https://epiverse-trace.github.io/numberize/">{numberize}</a>
package and takes the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: A data frame or linelist (required).</li>
<li><strong>target_columns</strong>: A vector containing the names of
the columns of interest. When dealing with a linelist, this can be set
to <code>linelist_tags</code> if the tagged columns are the one to be
converted into numeric. When <code>target_columns = NULL</code>, the
function uses the output form the <code>scan_data()</code> function to
identify the columns where the proportion of numeric values is at least
twice as the percentage of character values. Those columns will be the
columns of interest and the character values in them will be converted
into numeric.<br />
Note that any string in such column that can not be converted into
numeric will be set to <code>NA</code> in the resulting data.</li>
<li><strong>lang</strong>: A character string with the language in which
the letters are written. Currently one of
<code>&quot;en&quot;, &quot;fr&quot;, or &quot;es&quot;</code> for English, French or Spanish
respectively.</li>
</ol>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># CONVERT THE &#39;age&#39; COLUMN IN THE </span><span class="al">TEST</span><span class="co"> LINELIST DATA</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;messy_data.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="fu">head</span>(dat<span class="sc">$</span>age, <span class="dv">10</span><span class="dt">L</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;37&quot;           &quot;seventy-four&quot; &quot;17&quot;           &quot;3&quot;            &quot;37&quot;          </span></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co">#&gt;  [6] NA             &quot;6&quot;            &quot;26&quot;           &quot;eleven&quot;       &quot;44&quot;</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">convert_to_numeric</span>(</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="at">data =</span> dat,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;age&quot;</span>,</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>  <span class="at">lang =</span> <span class="st">&quot;en&quot;</span></span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>)</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a><span class="fu">head</span>(dat<span class="sc">$</span>age, <span class="dv">10</span><span class="dt">L</span>)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a><span class="co">#&gt;  [1] 37 74 17  3 37 NA  6 26 11 44</span></span></code></pre></div>
</div>
<div id="converting-numeric-values-into-date" class="section level2">
<h2>Converting numeric values into date</h2>
<p>Some columns in a data frame might contain numeric values that
represents the number of days elapsed between two events. For instance,
the recruitment day of individuals in a study can be stored as a numeric
column where the numeric values are the count of days between when they
are recruited and when there were admitted in the hospital. The actual
dates when the individuals were recruited can be retrieved using the
<code>convert_numeric_to_date()</code> function. This function can take
the following parameters:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: the input data frame or linelist.</li>
<li><strong>target_columns</strong>: a vector or a comma-separated list
of columns names to be converted from numeric to date. When the input
data is a <code>linelist</code> object, this parameter can be set to
<code>linelist_tags</code> if tagged variables are the target
columns.</li>
<li><strong>ref_date</strong>: a reference date</li>
<li><strong>forward</strong>: a Boolean that indicates whether the
counts started after the reference date (<code>TRUE</code>) or not
(<code>FALSE</code>). The default is <code>TRUE</code>.</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  <span class="fu">standardize_dates</span>(<span class="at">target_columns =</span> <span class="st">&quot;date.of.admission&quot;</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co"># CREATE THE RECRUITMENT DATE COLUMNS</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>data<span class="sc">$</span>recruitment_date <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">20</span><span class="sc">:</span><span class="dv">50</span>, <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co"># RETRIVE THE DATE INDIVIDUALS WERE RECRUITED FROM THEIR DATE OF ADMISSION</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">convert_numeric_to_date</span>(</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;recruitment_date&quot;</span>,</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>  <span class="at">ref_date =</span> <span class="st">&quot;date.of.admission&quot;</span>,</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>  <span class="at">forward =</span> <span class="cn">TRUE</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>)</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a></span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a><span class="co"># RETRIVE THE DATE INDIVIDUALS WERE RECRUITED FROM 2019-10-13</span></span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">convert_numeric_to_date</span>(</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;recruitment_date&quot;</span>,</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a>  <span class="at">ref_date =</span> <span class="fu">as.Date</span>(<span class="st">&quot;2019-10-13&quot;</span>),</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>  <span class="at">forward =</span> <span class="cn">FALSE</span></span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>)</span></code></pre></div>
<p>The function returns the input data where the values in the target
columns(s) are converted into Date. This enables the usage of
<strong>{cleanepi}’s</strong> functions that operates on Date columns as
well as the powerful functions that can be used to manipulate Dates from
the {base} R or {lubridate} packages.</p>
</div>
<div id="finding-duplicated-rows" class="section level2">
<h2>Finding duplicated rows</h2>
<p>The <code>find_duplicates()</code> function serves the purpose of
identifying duplicated rows within a given dataset. It accepts the
following parameters:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: The input data frame or linelist.</li>
<li><strong>target_columns</strong>: A vector containing either column
names or column indices from which duplicated rows will be identified.
If <code>NULL</code> is passed, duplicates will be detected across all
columns of the dataset. Notably, if the input dataset is a
<code>linelist</code> object, <code>target_columns</code> can be set to
<code>linelist_tags</code> specifically to identify duplicates across
the tagged variables only.</li>
</ol>
<p>By leveraging the <code>find_duplicates()</code> function with
appropriate parameters, users can efficiently pinpoint duplicated rows
within their datasets, either across all columns or selectively across
tagged variables in a <code>linelist</code> object.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># IMPORT A `linelist` DATA</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_linelist.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co"># SHOW THE TAGGED VARIABLES</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>linelist<span class="sc">::</span><span class="fu">tags</span>(data)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; $date_onset</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; [1] &quot;dt_onset&quot;</span></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a><span class="co">#&gt; $date_reporting</span></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a><span class="co">#&gt; [1] &quot;dt_report&quot;</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co">#&gt; $gender</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a><span class="co">#&gt; [1] &quot;sex&quot;</span></span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a><span class="co">#&gt; $outcome</span></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co">#&gt; [1] &quot;outcome&quot;</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co"># FIND DUPLICATES ACROSS ALL COLUMNS EXCEPT THE SUBJECT ids COLUMN</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a>all_columns <span class="ot">&lt;-</span> <span class="fu">names</span>(data)</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a>target_columns <span class="ot">&lt;-</span> all_columns[all_columns <span class="sc">!=</span> <span class="st">&quot;id&quot;</span>]</span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a>dups <span class="ot">&lt;-</span> <span class="fu">find_duplicates</span>(</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a>  <span class="at">target_columns =</span> target_columns</span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a>)</span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="co">#&gt; ℹ No duplicates were found.</span></span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a></span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a><span class="co"># FIND DUPLICATES ACROSS TAGGED VARIABLES</span></span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a>dups <span class="ot">&lt;-</span> <span class="fu">find_duplicates</span>(</span>
<span id="cb21-31"><a href="#cb21-31" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb21-32"><a href="#cb21-32" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;linelist_tags&quot;</span></span>
<span id="cb21-33"><a href="#cb21-33" tabindex="-1"></a>)</span>
<span id="cb21-34"><a href="#cb21-34" tabindex="-1"></a><span class="co">#&gt; ! Found 57 duplicated rows in the dataset.</span></span>
<span id="cb21-35"><a href="#cb21-35" tabindex="-1"></a><span class="co">#&gt; ℹ Use `attr(dat, &quot;report&quot;)[[&quot;duplicated_rows&quot;]]` to access them, where &quot;dat&quot; is</span></span>
<span id="cb21-36"><a href="#cb21-36" tabindex="-1"></a><span class="co">#&gt;   the object used to store the output from this operation.</span></span></code></pre></div>
<p>Upon execution, the <code>find_duplicates()</code> function
identifies all duplicated rows either based on all columns or those
specified, and stores them in the report, where in addition to the
existing columns, it appends two extra columns to the dataset:</p>
<ol style="list-style-type: decimal">
<li><code>row_id</code>: Contains indices of the duplicated rows from
the original input dataset.</li>
<li><code>group_id</code>: Contains unique identifiers assigned to each
duplicated group, which is defined as a set of rows sharing identical
values in the designated columns of interest.</li>
</ol>
<p>By including these extra columns, users gain insights into the
specific rows identified as duplicates and their corresponding group
identifiers, enabling efficient analysis and management of duplicated
data within the dataset.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># DISPLAY THE DUPLICATES</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>report <span class="ot">&lt;-</span> <span class="fu">attr</span>(dups, <span class="st">&quot;report&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> report<span class="sc">$</span>duplicated_rows</span></code></pre></div>
</div>
<div id="removing-duplicates" class="section level2">
<h2>Removing duplicates</h2>
<p>To eliminate duplicated rows from a dataset, the
<code>remove_duplicates()</code> function can be employed. This function
internally utilizes the <code>find_duplicates()</code> function and
expects the following parameters:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: A data frame or linelist from which
duplicated rows will be removed.</li>
<li><strong>target_columns</strong>: A vector containing either column
names or indices specifying the columns from which duplicated rows will
be identified. If set to <code>NULL</code>, the function will remove
duplicates across all columns. If the input dataset is a
<code>linelist</code> object, setting this parameter to
<code>linelist_tags</code> will identify and remove duplicates across
the tagged variables only.</li>
</ol>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># REMOVE DUPLICATE ACROSS TAGGED COLUMNS ONLY.</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">remove_duplicates</span>(</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="at">data =</span> <span class="fu">readRDS</span>(</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>    <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_linelist.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>  ),</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>  <span class="at">target_columns =</span> <span class="st">&quot;linelist_tags&quot;</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>)</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; ! Found 57 duplicated rows in the dataset.</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; ℹ Use `attr(dat, &quot;report&quot;)[[&quot;duplicated_rows&quot;]]` to access them, where &quot;dat&quot; is</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt;   the object used to store the output from this operation.</span></span></code></pre></div>
<p>Upon execution, the <code>remove_duplicates()</code> function returns
the input dataset without duplicated rows removed (if found). The
details about the duplicates removal operation are stored in the report
object that is attached to the output object. When duplicates are found,
this report will contain the following elements:</p>
<ul>
<li><strong>duplicated_rows</strong>: A data frame with the detected
duplicates.</li>
<li><strong>removed_duplicates</strong>: A data frame with the
duplicated rows that have been removed.</li>
<li><strong>duplicates_checked_from</strong>: A vector of column names
from which duplicates were identified.</li>
</ul>
<p>By examining these elements within the report, users gain insights
into the specific duplicated rows, those that were removed, and the
columns used to identify the duplicates, thus facilitating transparency
and documentation of the duplicates removal process.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># ACCESS THE REPORT</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>report <span class="ot">&lt;-</span> <span class="fu">attr</span>(res, <span class="st">&quot;report&quot;</span>)</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co"># SUMMARIZE THE REPORT OBJECT</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="fu">summary</span>(report)</span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co">#&gt;                         Length Class      Mode     </span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="co">#&gt; duplicated_rows         6      grouped_df list     </span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="co">#&gt; duplicates_checked_from 1      -none-     character</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="co">#&gt; removed_duplicates      5      grouped_df list</span></span></code></pre></div>
<p>Use the <code>print_report()</code> function to display the report
made from this operation.</p>
</div>
<div id="dictionary-based-data-substituting" class="section level2">
<h2>Dictionary based data substituting</h2>
<p>The <code>clean_using_dictionary()</code> function offers a
convenient way to replace the options in a data frame or linelist with
their corresponding values stored in a data dictionary. The function
expects the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: The input data frame or linelist that
contains the options to be replaced.</li>
<li><strong>dictionary</strong>: The data dictionary in a form of a data
frame that contains the complete labels for these options. The structure
of this data dictionary file should adhere to the standards expected by
the <a href="https://www.repidemicsconsortium.org/matchmaker/">{matchmaker}</a>
package, as the <code>clean_using_dictionary()</code> function relies on
functions from this package.</li>
</ol>
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
options
</th>
<th style="text-align:left;">
values
</th>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
orders
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
<p>The <code>add_to_dictionary()</code> function is a useful tool for
expanding the coverage of a data dictionary by defining options that are
present in the input data but not originally included in the dictionary.
This function enables users to dynamically update the dictionary to
accommodate new values encountered in the dataset. In addition to the
current data dictionary the function takes the arguments defined
below:</p>
<p><strong>option, value, grp, order</strong>: the values for the
options to be added in the data dictionary. The example below shows how
this function is used.</p>
<p>By employing the <code>add_to_dictionary()</code> function, users can
ensure that the data dictionary remains comprehensive and aligned with
the evolving nature of the input dataset, thereby enhancing the accuracy
and completeness of data interpretation and analysis. In the example
below, we add <code>-99</code> to our test data dictionary,
<code>test_dictionary</code>.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># READING IN THE DATA</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)</span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>)</span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co"># ADD THE EXTRA OPTION TO THE DICTIONARY</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>dictionary <span class="ot">&lt;-</span> <span class="fu">add_to_dictionary</span>(</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>  <span class="at">dictionary =</span> dictionary,</span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>  <span class="at">option =</span> <span class="st">&quot;-99&quot;</span>,</span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a>  <span class="at">value =</span> <span class="st">&quot;unknow&quot;</span>,</span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a>  <span class="at">grp =</span> <span class="st">&quot;sex&quot;</span>,</span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a>  <span class="at">order =</span> <span class="cn">NULL</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a>)</span></code></pre></div>
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
options
</th>
<th style="text-align:left;">
values
</th>
<th style="text-align:left;">
grp
</th>
<th style="text-align:right;">
orders
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
male
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
2
</td>
<td style="text-align:left;">
female
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
unknow
</td>
<td style="text-align:left;">
sex
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># PERFORM THE DICTIONARY-BASED SUBSTITUTION</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>cleaned_df <span class="ot">&lt;-</span> <span class="fu">clean_using_dictionary</span>(</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  <span class="at">dictionary =</span> dictionary</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
01/12/2020
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
Dec 01, 2020
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/01/2021
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
Jan 01, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
15/02/2021
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
Feb 11, 2021
</td>
<td style="text-align:left;">
unknow
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
11/02/2021
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
Feb 01, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
Feb 16, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
17/02/2021
</td>
<td style="text-align:left;">
-99
</td>
<td style="text-align:left;">
May 02, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
28/02/2021
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
Feb 19, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
22/02/2021
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
Sep 20, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
02/03/2021
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
Feb 26, 2021
</td>
<td style="text-align:left;">
male
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
05/03/2021
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
Mar 03, 2021
</td>
<td style="text-align:left;">
female
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="calculating-time-span-in-different-time-scales-years-months-weeks-or-days" class="section level2">
<h2>Calculating time span in different time scales (“years”, “months”,
“weeks”, or “days”)</h2>
<p>The <code>timespan()</code> function computes the time span between
two elements of type Date. The resulting time span can be expressed in
“years”, “months”, “weeks”, or “days”, depending on the user-specified
unit. The functions can take the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data</strong>: The input dataset (required).</li>
<li><strong>target_column</strong>: A string with the name of the target
column (require). The values in this column are expected to be in the
form of <code>Ymd</code> i.e. <code>2024-01-31</code>. The time span
will be calculated between these values and the <code>end_date</code>
defined below.</li>
<li><strong>end_date</strong>: It can be either a character that is the
name of another column of type Date from the input data or a vector of
Date values or a single Date value (required). This should also be in
the ISO8601 format (“2024-01-31”) and its default value is today’s date
<code>Sys.Date()</code>.</li>
<li><strong>span_unit</strong>: This parameter determines the unit in
which the time span is expressed (required). It can be calculated in
“years”, “months”, “weeks”, or “days”. By default, the time span is
calculated in “years” if this parameter is not provided.</li>
<li><strong>span_column_name</strong>: A string for the name of the
column added to the input data. The default is <code>span</code>.</li>
<li><strong>span_remainder_unit</strong>: A parameter used to determine
the unit in which the remainder of the time span calculation will be
returned. The possible units are: “days” or “weeks” or “months”. By
default, the function returns decimal values
i.e. <code>span_remainder_unit = NULL</code>.</li>
</ol>
<p>With these arguments, the function offers flexibility in determining
the time span in different units. It facilitates various analytics tasks
where the time span computation is a necessary component, providing
users with the ability to customize the output according to their
specific requirements.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># IMPORT DATA, REPLACE MISSING VALUES WITH &#39;NA&#39; &amp; STANDARDIZE DATES</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="fu">replace_missing_values</span>(</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>    <span class="at">target_columns =</span> <span class="st">&quot;dateOfBirth&quot;</span>,</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>    <span class="at">na_strings =</span> <span class="st">&quot;-99&quot;</span></span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  <span class="fu">standardize_dates</span>(</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>    <span class="at">target_columns =</span> <span class="st">&quot;dateOfBirth&quot;</span>,</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>    <span class="at">error_tolerance =</span> <span class="fl">0.0</span>,</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>    <span class="at">format =</span> <span class="st">&quot;%m/%d/%Y&quot;</span> <span class="co"># nolint: nonportable_path_linter.</span></span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>  )</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a><span class="co">#&gt; ℹ The target  column will be standardized using the format: &quot;%m/%d/%Y&quot;.</span></span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a><span class="co"># CALCULATE INDIVIDUAL AGE IN YEARS FROM THE &#39;dateOfBirth&#39; COLUMN AND SEND THE</span></span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a><span class="co"># REMAINDER IN MONTHS</span></span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a>age <span class="ot">&lt;-</span> <span class="fu">timespan</span>(</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a>  <span class="at">target_column =</span> <span class="st">&quot;dateOfBirth&quot;</span>,</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>  <span class="at">end_date =</span> <span class="fu">Sys.Date</span>(),</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>  <span class="at">span_unit =</span> <span class="st">&quot;years&quot;</span>,</span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a>  <span class="at">span_column_name =</span> <span class="st">&quot;age_in_years&quot;</span>,</span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a>  <span class="at">span_remainder_unit =</span> <span class="st">&quot;months&quot;</span></span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>)</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a><span class="co"># CALCULATE THE TIME SPAN IN DAYS BETWEEN INDIVIDUALS DATE OF ADMISSION AND THE</span></span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a><span class="co"># DAY THEY TESTED POSITIVE</span></span>
<span id="cb27-27"><a href="#cb27-27" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb27-28"><a href="#cb27-28" tabindex="-1"></a>dat <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb27-29"><a href="#cb27-29" tabindex="-1"></a>  <span class="fu">replace_missing_values</span>(</span>
<span id="cb27-30"><a href="#cb27-30" tabindex="-1"></a>    <span class="at">target_columns =</span> <span class="st">&quot;dateOfBirth&quot;</span>,</span>
<span id="cb27-31"><a href="#cb27-31" tabindex="-1"></a>    <span class="at">na_strings =</span> <span class="st">&quot;-99&quot;</span></span>
<span id="cb27-32"><a href="#cb27-32" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-33"><a href="#cb27-33" tabindex="-1"></a>  <span class="fu">standardize_dates</span>(</span>
<span id="cb27-34"><a href="#cb27-34" tabindex="-1"></a>    <span class="at">target_columns =</span> <span class="fu">c</span>(<span class="st">&quot;date_first_pcr_positive_test&quot;</span>, <span class="st">&quot;date.of.admission&quot;</span>),</span>
<span id="cb27-35"><a href="#cb27-35" tabindex="-1"></a>    <span class="at">error_tolerance =</span> <span class="fl">0.0</span>,</span>
<span id="cb27-36"><a href="#cb27-36" tabindex="-1"></a>    <span class="at">format =</span> <span class="cn">NULL</span></span>
<span id="cb27-37"><a href="#cb27-37" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb27-38"><a href="#cb27-38" tabindex="-1"></a>  <span class="fu">timespan</span>(</span>
<span id="cb27-39"><a href="#cb27-39" tabindex="-1"></a>    <span class="at">target_column =</span> <span class="st">&quot;date_first_pcr_positive_test&quot;</span>,</span>
<span id="cb27-40"><a href="#cb27-40" tabindex="-1"></a>    <span class="at">end_date =</span> <span class="st">&quot;date.of.admission&quot;</span>,</span>
<span id="cb27-41"><a href="#cb27-41" tabindex="-1"></a>    <span class="at">span_unit =</span> <span class="st">&quot;days&quot;</span>,</span>
<span id="cb27-42"><a href="#cb27-42" tabindex="-1"></a>    <span class="at">span_column_name =</span> <span class="st">&quot;elapsed_days&quot;</span>,</span>
<span id="cb27-43"><a href="#cb27-43" tabindex="-1"></a>    <span class="at">span_remainder_unit =</span> <span class="cn">NULL</span></span>
<span id="cb27-44"><a href="#cb27-44" tabindex="-1"></a>  )</span></code></pre></div>
<p>The <code>timespan()</code> function augments the input dataset by
adding one or two extra columns containing age-related information.
These additional columns are as follows:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Calculated time span in the specified scale</strong>:
Contains the calculated time span in the specified unit (“years”,
“months”, “weeks”, or “days”).</p></li>
<li><p><strong>Remainder from the time span calculation</strong>:
Indicates the remaining number of “days” or “weeks” or “months” after
calculating the time span, representing the fractional part of the time
span calculation. This column is included if needed, and provides
additional granularity in the time span representation.</p></li>
</ol>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class=" lightable-paper lightable-striped" style="font-size: 14px; font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
study_id
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
event_name
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
country_code
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
country_name
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date.of.admission
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
dateOfBirth
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
date_first_pcr_positive_test
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
elapsed_days
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
PS001P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2020-12-01
</td>
<td style="text-align:left;">
06/01/1972
</td>
<td style="text-align:left;">
2020-12-01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
PS002P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-01-28
</td>
<td style="text-align:left;">
02/20/1952
</td>
<td style="text-align:left;">
2021-01-01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:left;">
PS004P2-1
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-15
</td>
<td style="text-align:left;">
06/15/1961
</td>
<td style="text-align:left;">
2021-02-11
</td>
<td style="text-align:right;">
-99
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
PS003P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-11
</td>
<td style="text-align:left;">
11/11/1947
</td>
<td style="text-align:left;">
2021-02-01
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;">
P0005P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-17
</td>
<td style="text-align:left;">
09/26/2000
</td>
<td style="text-align:left;">
2021-02-16
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
PS006P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-17
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
2021-05-02
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-74
</td>
</tr>
<tr>
<td style="text-align:left;">
PB500P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-28
</td>
<td style="text-align:left;">
11/03/1989
</td>
<td style="text-align:left;">
2021-02-19
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
PS008P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-02-22
</td>
<td style="text-align:left;">
10/05/1976
</td>
<td style="text-align:left;">
2021-09-20
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
-210
</td>
</tr>
<tr>
<td style="text-align:left;">
PS010P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-03-02
</td>
<td style="text-align:left;">
09/23/1991
</td>
<td style="text-align:left;">
2021-02-26
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;">
PS011P2
</td>
<td style="text-align:left;">
day 0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Gambia
</td>
<td style="text-align:left;">
2021-03-05
</td>
<td style="text-align:left;">
02/08/1991
</td>
<td style="text-align:left;">
2021-03-03
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="using-cleanepi-functionalities-with-pipe-operators" class="section level2">
<h2>Using {cleanepi} functionalities with pipe operators</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># IMPORT THE INPUT DATASET</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_df.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>))</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co"># IMPORT THE DATA DICTIONARY</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>test_dictionary <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;test_dictionary.RDS&quot;</span>, <span class="at">package =</span> <span class="st">&quot;cleanepi&quot;</span>)</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>)</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="co"># SCAN THROUGH THE DATA</span></span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>scan_res <span class="ot">&lt;-</span> <span class="fu">scan_data</span>(data)</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a><span class="co"># PERFORM DATA CLEANING</span></span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>  <span class="fu">standardize_column_names</span>(<span class="at">keep =</span> <span class="cn">NULL</span>, <span class="at">rename =</span> <span class="fu">c</span>(<span class="at">DOB =</span> <span class="st">&quot;dateOfBirth&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a>  <span class="fu">replace_missing_values</span>(<span class="at">target_columns =</span> <span class="cn">NULL</span>, <span class="at">na_strings =</span> <span class="st">&quot;-99&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>  <span class="fu">remove_constants</span>(<span class="at">cutoff =</span> <span class="fl">1.0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a>  <span class="fu">remove_duplicates</span>(<span class="at">target_columns =</span> <span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>  <span class="fu">standardize_dates</span>(</span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>    <span class="at">target_columns =</span> <span class="cn">NULL</span>,</span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a>    <span class="at">error_tolerance =</span> <span class="fl">0.4</span>,</span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a>    <span class="at">format =</span> <span class="cn">NULL</span>,</span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a>    <span class="at">timeframe =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">&quot;1973-05-29&quot;</span>, <span class="st">&quot;2023-05-29&quot;</span>))</span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a>  <span class="fu">check_subject_ids</span>(</span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a>    <span class="at">target_columns =</span> <span class="st">&quot;study_id&quot;</span>,</span>
<span id="cb28-26"><a href="#cb28-26" tabindex="-1"></a>    <span class="at">prefix =</span> <span class="st">&quot;PS&quot;</span>,</span>
<span id="cb28-27"><a href="#cb28-27" tabindex="-1"></a>    <span class="at">suffix =</span> <span class="st">&quot;P2&quot;</span>,</span>
<span id="cb28-28"><a href="#cb28-28" tabindex="-1"></a>    <span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="dt">L</span>, <span class="dv">100</span><span class="dt">L</span>),</span>
<span id="cb28-29"><a href="#cb28-29" tabindex="-1"></a>    <span class="at">nchar =</span> <span class="dv">7</span><span class="dt">L</span></span>
<span id="cb28-30"><a href="#cb28-30" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb28-31"><a href="#cb28-31" tabindex="-1"></a>  <span class="fu">convert_to_numeric</span>(<span class="at">target_columns =</span> <span class="st">&quot;sex&quot;</span>, <span class="at">lang =</span> <span class="st">&quot;en&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb28-32"><a href="#cb28-32" tabindex="-1"></a>  <span class="fu">clean_using_dictionary</span>(<span class="at">dictionary =</span> test_dictionary)</span>
<span id="cb28-33"><a href="#cb28-33" tabindex="-1"></a><span class="co">#&gt; ℹ No duplicates were found.</span></span>
<span id="cb28-34"><a href="#cb28-34" tabindex="-1"></a><span class="co">#&gt; ! Detected 3 invalid subject ids at lines: &quot;3, 5, 7&quot;.</span></span>
<span id="cb28-35"><a href="#cb28-35" tabindex="-1"></a><span class="co">#&gt; ℹ You can use the `correct_subject_ids()` function to correct them.</span></span>
<span id="cb28-36"><a href="#cb28-36" tabindex="-1"></a></span>
<span id="cb28-37"><a href="#cb28-37" tabindex="-1"></a><span class="co"># ADD THE DATA SCANNING RESULT TO THE REPORT</span></span>
<span id="cb28-38"><a href="#cb28-38" tabindex="-1"></a>cleaned_data <span class="ot">&lt;-</span> <span class="fu">add_to_report</span>(</span>
<span id="cb28-39"><a href="#cb28-39" tabindex="-1"></a>   <span class="at">x =</span> cleaned_data,</span>
<span id="cb28-40"><a href="#cb28-40" tabindex="-1"></a>   <span class="at">key =</span> <span class="st">&quot;scanning_result&quot;</span>,</span>
<span id="cb28-41"><a href="#cb28-41" tabindex="-1"></a>   <span class="at">value =</span> scan_res</span>
<span id="cb28-42"><a href="#cb28-42" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="printing-the-report" class="section level2">
<h2>Printing the report</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">print_report</span>(</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>  <span class="at">data =</span> cleaned_data,</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="at">report_title =</span> <span class="st">&quot;{cleanepi} data cleaning report&quot;</span>,</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>  <span class="at">output_directory =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  <span class="at">output_file_name =</span> <span class="cn">NULL</span>,</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  <span class="at">format =</span> <span class="st">&quot;html&quot;</span>,</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>  <span class="at">print =</span> <span class="cn">TRUE</span></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
